<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>School Photo Editor</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"></script>

<style>
body {
  font-family: Arial;
  background:#f2f4f7;
  margin:0;
  padding:20px;
}

.controls {
  max-width:900px;
  margin:auto;
  background:white;
  padding:20px;
  border-radius:8px;
  box-shadow:0 0 10px rgba(0,0,0,0.1);
}

button, input {
  padding:10px;
  margin-top:10px;
  width:100%;
}

canvas {
  display:none;
  margin:20px auto;
  border:1px solid #ccc;
  background:white;
}
</style>
</head>

<body>

<div class="controls">
  <h2>ðŸ“¸ School Photo Editor</h2>

  <input type="file" id="upload" multiple accept="image/*">

  <button onclick="generateCanvas()">Generate Canvas</button>
  <button onclick="downloadImage()">Download Final Image</button>
</div>

<canvas id="canvas" width="1240" height="1754"></canvas>

<script>
let canvas = new fabric.Canvas('canvas');

function generateCanvas(){
  document.getElementById("canvas").style.display = "block";
  canvas.clear();

  // Header
  let title = new fabric.Text(
    "SRI CHAITANYA INTERNATIONAL SCHOOL",
    {
      left: 620,
      top: 40,
      fontSize: 28,
      originX: 'center',
      fontWeight: 'bold'
    }
  );

  canvas.add(title);

  const files = document.getElementById('upload').files;

  let x = 50;
  let y = 120;

  Array.from(files).forEach((file, index)=>{
    let reader = new FileReader();

    reader.onload = function(f){
      fabric.Image.fromURL(f.target.result, function(img){

        img.set({
          left: x,
          top: y,
          scaleX: 0.3,
          scaleY: 0.3,
          cornerStyle: 'circle',
          transparentCorners: false
        });

        canvas.add(img);

        x += 250;
        if(x > 900){
          x = 50;
          y += 250;
        }
      });
    }

    reader.readAsDataURL(file);
  });
}

function downloadImage(){
  const dataURL = canvas.toDataURL({
    format: 'jpeg',
    quality: 0.95
  });

  const link = document.createElement('a');
  link.href = dataURL;
  link.download = "final-school-sheet.jpg";
  link.click();
}
</script>

</body>
</html>
